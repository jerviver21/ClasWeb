
<html  xmlns="http://www.w3.org/1999/xhtml"
     xmlns:h="http://java.sun.com/jsf/html"
     xmlns:f="http://java.sun.com/jsf/core"
     xmlns:ui="http://java.sun.com/jsf/facelets"
     xmlns:p="http://primefaces.org/ui"
     >


    <f:view>

        <ui:composition template="../#{applicationController.plan2}">
            <ui:define name="contenido">
                <h:form id="form2">
                    <span class="menu">
                        <h:link outcome="/publicacion/precios.xhtml" value="Ver Precios"/>
                        <p:spacer width="10"/>
                        <p:commandLink action="#{publicacionController.verPedido}" value="Ver Pedido" ajax="false"/>
                    </span>
                </h:form>
                    <br/>
                    <span class="titulo">Publique su Clasificado</span>
                    <br/>
               <h:form id="form" prependId="false">
                    <p:growl id="msgs" />   
                    <p:panelGrid style="margin-top:20px">
                        <p:row>
                            <p:column><h:outputLabel  value="Tipo de Clasificado:" /></p:column>
                            <p:column><h:selectOneMenu id="tipo" value="#{publicacionController.clasificado.tipo.id}" valueChangeListener="#{publicacionController.cambiarTipo}">
                            <p:ajax update="@form"/>
                            <f:selectItems  value="#{publicacionController.tipos}"/>
                            </h:selectOneMenu></p:column>
                            <p:column><p:watermark value="Seleccione..." for="tipo"/></p:column>
                        </p:row>
                        <p:row rendered="#{publicacionController.tipoClasificado.campos.subtipo1}">
                            <p:column><h:outputLabel  value="#{publicacionController.nsubtipo1}"/></p:column>
                            <p:column><h:selectOneMenu id="sub1" value="#{publicacionController.clasificado.subtipo1.id}">
                                <p:ajax update="@form"/>
                                <f:selectItems  value="#{publicacionController.subtipos1}"/>
                            </h:selectOneMenu></p:column>
                            <p:column><p:message for="tipo"/></p:column>
                        </p:row>
                        <p:row rendered="#{publicacionController.tipoClasificado.campos.subtipo2}">
                            <p:column><h:outputLabel  value="#{publicacionController.nsubtipo2}"/></p:column>
                            <p:column><h:selectOneMenu id="sub2" value="#{publicacionController.clasificado.subtipo2.id}">
                                <p:ajax update="@form"/>
                                <f:selectItems  value="#{publicacionController.subtipos2}"/>
                            </h:selectOneMenu></p:column>
                            <p:column><p:message for="tipo"/></p:column>
                        </p:row>
                        <p:row rendered="#{publicacionController.tipoClasificado.campos.subtipo3}">
                            <p:column><h:outputLabel  value="#{publicacionController.nsubtipo3}"/></p:column>
                            <p:column><h:selectOneMenu id="sub3" value="#{publicacionController.clasificado.subtipo3.id}">
                                <p:ajax update="@form"/>
                                <f:selectItems  value="#{publicacionController.subtipos3}"/>
                            </h:selectOneMenu></p:column>
                            <p:column><p:message for="tipo"/></p:column>
                        </p:row>
                        <p:row rendered="#{publicacionController.tipoClasificado.campos.subtipo4}">
                            <p:column><h:outputLabel  value="#{publicacionController.nsubtipo4}"/></p:column>
                            <p:column><h:selectOneMenu id="sub4" value="#{publicacionController.clasificado.subtipo4.id}">
                                <p:ajax update="@form"/>
                                <f:selectItems  value="#{publicacionController.subtipos4}"/>
                            </h:selectOneMenu></p:column>
                            <p:column><p:message for="tipo"/></p:column>
                        </p:row>
                        <p:row rendered="#{publicacionController.tipoClasificado.campos.subtipo5}">
                            <p:column><h:outputLabel  value="#{publicacionController.nsubtipo5}"/></p:column>
                            <p:column><h:selectOneMenu id="sub5" value="#{publicacionController.clasificado.subtipo5.id}">
                                <p:ajax update="@form"/>
                                <f:selectItems  value="#{publicacionController.subtipos5}"/>
                            </h:selectOneMenu></p:column>
                            <p:column><p:message for="tipo"/></p:column>
                        </p:row>
                        
                        <p:row rendered="#{publicacionController.tipoClasificado.campos.valor}">
                            <p:column>
                                <h:outputLabel  value="PRECIO:" rendered="#{publicacionController.clasificado.tipo.id eq 1 or publicacionController.clasificado.tipo.id eq 3}"/>
                                <h:outputLabel  value="SALARIO:" rendered="#{publicacionController.clasificado.tipo.id eq 2}" />
                            </p:column>
                            <p:column>
                                <p:inputText id="valorof1" value="#{publicacionController.clasificado.valorOferta}">
                                    <p:ajax update="@form"/>
                                </p:inputText>
                                <p:watermark value="Digite el entero sin signos, puntos, ni comas" for="valorof1"/>
                            </p:column>
                            <p:column>
                                <h:selectOneMenu id="moneda" value="#{publicacionController.clasificado.moneda.id}">
                                    <p:ajax update="@form"/>
                                    <f:selectItems  value="#{publicacionController.monedas}"/>
                                </h:selectOneMenu>
                            </p:column>
                            <p:column><p:message for="valorof1"/></p:column>
                        </p:row>
                        
                        <p:row>
                            <p:column><h:outputLabel  value="Fecha Inicial de Publicación: "/></p:column>
                            <p:column>
                                <p:calendar id="fechaini" value="#{publicacionController.clasificado.fechaIni}" size="40" 
                                            required="true" mindate="#{publicacionController.minDate}" pattern="yyyy-MM-dd">
                                    <p:ajax event="dateSelect" update="@form"/>
                                </p:calendar>
                            </p:column>
                            <p:column><p:message for="fechaini"/></p:column>
                            <p:column><p:watermark value="Seleccione..." for="fechaini"/></p:column>
                        </p:row>
                        <p:row>
                            <p:column><h:outputLabel  value="Fecha Final de Publicación:  "/></p:column>
                            <p:column>
                                <p:calendar id="fechafin" value="#{publicacionController.clasificado.fechaFin}" size="40" 
                                            required="true" mindate="#{publicacionController.clasificado.fechaIni}" pattern="yyyy-MM-dd">
                                    <p:ajax event="dateSelect"/>
                                </p:calendar>
                            </p:column>
                            <p:column><p:message for="fechafin"/></p:column>
                            <p:column><p:watermark value="Seleccione..." for="fechafin"/></p:column>
                        </p:row>
                        <p:row>
                            <p:column><h:outputLabel  value="Clasificado: "/></p:column>
                            <p:column>
                                <p:inputTextarea id="clasificado" value="#{publicacionController.clasificado.clasificado}" cols="40" required="true">
                                    <p:ajax update="@form"/>
                                </p:inputTextarea>
                            </p:column>
                            <p:column><p:message for="clasificado"/></p:column>
                            <p:column><p:watermark value="Escriba exactamente lo que quiere que se imprima en el clasificado" for="clasificado"/></p:column>
                        </p:row>
                        <!--<p:row id="rimg">
                            <p:column><h:outputLabel  value="Cargar Imagen: "/></p:column>
                            <p:column>
                                <p:commandButton id="img1" title="Cargar" value="Cargar" icon="ui-icon-arrowthickstop-1-n" oncomplete="dlg_img.show()"/>
                            </p:column>
                            <p:column><p:outputLabel value="{publicacionController.img1Msg}" rendered="{publicacionController.clasificado.imgCargada}"/></p:column>
                            <p:column><p:message for="img1"/></p:column>
                        </p:row>-->
                    </p:panelGrid>
                    
                    <br/>
                    <span class="titulo">Medios de Publicación</span>
                    <p:panelGrid columns="1" rendered="#{publicacionController.modoEdicion}">
                        <h:outputLabel  value="#{publicacionController.clasificado.tipoPublicacion.nombre}"/>
                    </p:panelGrid>
                    <p:panelGrid columns="2" rendered="#{!publicacionController.modoEdicion}">
                        <h:outputLabel  value="Seleccione los medios en que desea publicar: "/>
                        <p:spacer width="20" height="5"/>
                        <h:selectManyCheckbox id="tipopub" value="#{publicacionController.clasificado.opcionesPublicacion}">
                            <p:ajax update="@form"/>
                            <f:selectItems  value="#{publicacionController.tiposPublicacion}"/>
                        </h:selectManyCheckbox>
                    </p:panelGrid>
                    <br/>
                    <p:commandButton value="Agregar a Pedido" type="button" onclick="confirmation.show()" rendered="#{!publicacionController.modoEdicion}"/>
                    <p:commandButton value="Guardar Cambios" type="button" onclick="confirmation.show()" rendered="#{publicacionController.modoEdicion}"/>
                    
                    <p:confirmDialog id="confirm" message="#{publicacionController.clasificado}" severity="info"
                                     header="Así se publicará su clasificado: "  widgetVar="confirmation" width="400" height="100"  >  
                        <p:commandButton id="confirmbtn1" value="Si, Estoy de acuerdo"  oncomplete="confirmation.hide()"  ajax="false"
                                         action="#{publicacionController.procesarClasificado}" rendered="#{!publicacionController.modoEdicion}" /> 
                        <p:commandButton id="confirmbtn2" value="Si, Estoy de acuerdo"  oncomplete="confirmation.hide()"  ajax="false"
                                         action="#{publicacionController.procesarEdicion}" rendered="#{publicacionController.modoEdicion}" />  
                        <p:commandButton id="declinebtn" value="No" onclick="confirmation.hide()" type="button" />  
                    </p:confirmDialog>
                </h:form>
                
                <p:dialog widgetVar="dlg_img" modal="true" width="400" height="300">
                    <h:form id="form1" enctype="multipart/form-data">
                        <p:panel header="Cargar Imagen - Tamaño máximo 500k">
                            <p:panelGrid columns="2">
                                <h:outputLabel value="Cargar"/>
                                <p:fileUpload fileUploadListener="#{publicacionController.cargarImg}" 
                                              mode="advanced" update=":form" auto="true"
                                                allowTypes="/(\.|\/)(gif|jpe?g|png)$/" sizeLimit="500000"
                                                label="Seleccionar" oncomplete="dlg_img.hide()"/> 
                            </p:panelGrid>
                        </p:panel>
                    </h:form>
                </p:dialog>
            </ui:define>
        </ui:composition>
    </f:view>

</html>
